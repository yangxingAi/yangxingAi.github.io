

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Anh Tinh">
  <meta name="keywords" content="">
  
    <meta name="description" content="# 数据库MySQL 一、数据库基础 用管理员身份运行CMD，输入以下代码 12345mysql -h -u root -p&#x2F;*-h(主机名)-u(用户名)-p(密码)*&#x2F;  即可以连接成功。  查看全部数据库 1show databases;  创建数据库 123456CREATE DATABASE IF NOT EXISTS test_db;#[IF NOT EXISTS ]:表示如果存在则">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库MySQL">
<meta property="og:url" content="http://example.com/2024/05/27/%E6%95%B0%E6%8D%AE%E5%BA%93MySQL%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9D%9F/index.html">
<meta property="og:site_name" content="Anh Tinh yêu vợ">
<meta property="og:description" content="# 数据库MySQL 一、数据库基础 用管理员身份运行CMD，输入以下代码 12345mysql -h -u root -p&#x2F;*-h(主机名)-u(用户名)-p(密码)*&#x2F;  即可以连接成功。  查看全部数据库 1show databases;  创建数据库 123456CREATE DATABASE IF NOT EXISTS test_db;#[IF NOT EXISTS ]:表示如果存在则">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-05-27T03:10:07.000Z">
<meta property="article:modified_time" content="2024-05-27T03:25:54.953Z">
<meta property="article:author" content="Anh Tinh">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>数据库MySQL - Anh Tinh yêu vợ</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Anh Tinh</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="数据库MySQL"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-05-27 11:10" pubdate>
          2024年5月27日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          59 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">数据库MySQL</h1>
            
            
              <div class="markdown-body">
                
                <p>﻿# 数据库MySQL</p>
<h2 id="一、数据库基础"><a href="#一、数据库基础" class="headerlink" title="一、数据库基础"></a>一、数据库基础</h2><ul>
<li><p>用管理员身份运行CMD，输入以下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql -h -u root -p<br>/*-h(主机名)<br>-u(用户名)<br>-p(密码)<br>*/<br></code></pre></td></tr></table></figure></li>
</ul>
<p>即可以连接成功。</p>
<ul>
<li><p>查看全部数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show databases;<br></code></pre></td></tr></table></figure>
</li>
<li><p>创建数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE DATABASE IF NOT EXISTS test_db;<br>#[IF NOT EXISTS ]:表示如果存在则不报错，不存在就创建数据库。<br>create database if not exists mydb2 character set gbk;<br>#创建一个gbk字符集的数据库<br>create database mydb3 character set gbk collate gbk_bin;<br>#创建一个gbk数据库，gbk校验字符集<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show databases;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示数据库创建语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">show create databases db_name;<br></code></pre></td></tr></table></figure>
</li>
<li><p>删除数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">drop databases [if exists] db_name; <br></code></pre></td></tr></table></figure>
</li>
<li><p>修改数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># 5.把mydb2的字符集修改为utf8;<br>alter database mydb2 character set utf8 collate utf8_bin;<br></code></pre></td></tr></table></figure>
</li>
<li><p>进入数据库和创建表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#进入数据库<br>use db_name;<br>#创建表，三个int字段<br>create table t_a(<br>	a int,<br>    b int,<br>    c int<br>)character set utf8 collate utf8_bin;<br></code></pre></td></tr></table></figure>
</li>
<li><p>查看数据库中所有表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查看当前数据库中所有表<br>show tables; <br>#查看指定数据库中所有表<br>show tables in db_name;<br></code></pre></td></tr></table></figure>
</li>
<li><p>数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">######################################## 数据类型 #####################################<br># 整数 tinyint(1字节), smallint(2字节), mediumint(3字节), int(4字节), bigint(8字节)<br># 小数 float(M,D)(4字节), double(M,D)(8字节), decimal(M,D)(M+2字节)<br>#其中，M称为精度，表示总共的位数；D称为标度，表示小数的位数。<br>#DECIMAL 类型不同于 FLOAT &amp; DOUBLE，DECIMAL 实际是以字符串存放的，它的存储空间并不固定，而是由精度 M 决定的。<br># 时间 year, time, date, datetime, timestamp<br>#datetime系统默认值是null，而timestamp的系统默认值是当前时间now。<br>#datetime存储时间与时区无关，而timestamp与时区有关。<br></code></pre></td></tr></table></figure>
</li>
<li><p>字符串类型</p>
<table>
<thead>
<tr>
<th align="center">类型名称</th>
<th align="center">占用字节</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">char(M)</td>
<td align="center">M, 1 &lt;&#x3D; M &lt;&#x3D; 255</td>
<td align="center">固定长度字符串</td>
</tr>
<tr>
<td align="center">varchar(M)</td>
<td align="center">L+1, L &lt;&#x3D;M, 1 &lt;&#x3D;M &lt;&#x3D;255</td>
<td align="center">变长字符串</td>
</tr>
<tr>
<td align="center">TINYTEXT</td>
<td align="center">L+1, L &lt; 2^8</td>
<td align="center">非常小的文本字符串</td>
</tr>
<tr>
<td align="center">TEXT</td>
<td align="center">L+2, L &lt; 2^16</td>
<td align="center">小的文本字符串</td>
</tr>
<tr>
<td align="center">MEDIUMTEXT</td>
<td align="center">L+3, L &lt; 2^24</td>
<td align="center">中等大小的文本字符串</td>
</tr>
<tr>
<td align="center">LONGTEXT</td>
<td align="center">L+4, L &lt; 2^32</td>
<td align="center">大的文本字符串</td>
</tr>
<tr>
<td align="center">ENUM</td>
<td align="center">1 或者 2个字节，取决于枚举的数目，最大 65535个</td>
<td align="center">枚举类型</td>
</tr>
<tr>
<td align="center">SET</td>
<td align="center">1,2,3,4或8个字节</td>
<td align="center">集合类型</td>
</tr>
</tbody></table>
</li>
<li><p>二进制类型</p>
<table>
<thead>
<tr>
<th align="center"><strong>类型名称</strong></th>
<th align="center"><strong>占用字节</strong></th>
<th align="center"><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">BIT(M)</td>
<td align="center">[(m+7)&#x2F;8]</td>
<td align="center">位字节类型</td>
</tr>
<tr>
<td align="center">BINARY(M)</td>
<td align="center">M</td>
<td align="center">固定长度的二进制数据</td>
</tr>
<tr>
<td align="center">VARBINARY(M)</td>
<td align="center">L+1</td>
<td align="center">可变长度的二进制数据</td>
</tr>
<tr>
<td align="center">TINYBLOB(M)</td>
<td align="center">L+1,  L &lt; 2^8</td>
<td align="center">非常小的  BLOB</td>
</tr>
<tr>
<td align="center">BLOB(M)</td>
<td align="center">L+2,  L &lt; 2^16</td>
<td align="center">小的  BLOB</td>
</tr>
<tr>
<td align="center">MEDIUMBLOB(M)</td>
<td align="center">L+3,  L &lt; 2^24</td>
<td align="center">中等大小的BLOB</td>
</tr>
<tr>
<td align="center">LONGBLOB(M)</td>
<td align="center">L+4,  L  &lt;  2^32</td>
<td align="center">非常大的BLOB</td>
</tr>
</tbody></table>
</li>
<li><p>添加时间表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table t_time (<br>	t1 datetime,<br>    t2 timestamp<br>);<br><br>insert into t_time (t1) values (now());<br>insert into t_time (t2) values (now());<br>select * from t_time;<br><br>set time_zone=&#x27;+10:00&#x27;; <br>select * from t_time;<br>set time_zone=&#x27;+8:00&#x27;;<br></code></pre></td></tr></table></figure>
</li>
<li><p>枚举类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table t_enum (<br>	gender enum(&#x27;female&#x27;, &#x27;male&#x27;),<br>    sex enum(&#x27;f&#x27;, &#x27;m&#x27;) not null<br>);<br><br>insert into t_enum(gender) values(&#x27;female&#x27;);<br># insert into t_enum(gender) values(&#x27;unkonw&#x27;);<br># insert into t_enum(gender) values(&#x27;female,male&#x27;);<br>insert into t_enum (sex) values(&#x27;f&#x27;);<br><br>select * from t_enum;<br></code></pre></td></tr></table></figure>
</li>
<li><p>集合类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table t_set(<br>	&#x27;score&#x27; set(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;)<br>);<br>#添加null<br>insert into t_set values(null);<br>#添加a<br>insert into t_set values(&#x27;a&#x27;);<br>#添加ab<br>insert into t_set values(&#x27;a&#x27;,&#x27;b&#x27;);<br>#添加abc,,,无论添加顺序如何，结果都是abc<br>insert into t_set values(&#x27;a&#x27;,&#x27;c&#x27;,&#x27;b&#x27;); <br></code></pre></td></tr></table></figure>
</li>
<li><p>创建员工表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table t_employees (<br>	id int,<br>    name varchar(20),<br>    gender enum(&#x27;female&#x27;, &#x27;male&#x27;),<br>    birthday date,<br>    entry_date date,<br>    job varchar(20),<br>    salary decimal(10, 2),<br>    `resume` blob<br>);<br># 查看表的结构<br>describe t_employees;<br>desc  t_employees;<br># 修改<br># 添加一列,uid,int类型<br>alter table t_employees add column uid int;<br>#在gender之后添加一个sex枚举<br>alter table t_employees add column sex enum(&#x27;female&#x27;,&#x27;male&#x27;) after gender;<br>#在第一列添加idcard varchar<br>alter table t_employees add column idcard varchar(20) first;<br>#把 resume修改为 varchar（50） 类型<br>alter table t_employees modify column &#x27;resume&#x27; varchar(50);<br>#把name列修改为username varchar（50）<br>alter table t_employees change column name username varchar(50);<br>#删除列<br>alter table t_employees drop id_card,drop uid,drop sex;<br>#修改表的名称<br>rename table t_employees to employees;<br>#移动表到另外一个数据库<br>rename table employees to mydb_2.t_employees;<br>#删除表<br>drop table t_a;<br>drop table  if exists t_a;<br>#复制表结构，不复制数据<br>create table employees like mydb_2.t_employees;<br>#复制表结构和数据<br>create table t_employees(select * from mydb2.t_employees);<br>################################DML#############################################<br>#插入数据<br>insert into employees values (1,&#x27;lishuai&#x27;,&#x27;male&#x27;,&#x27;1996-4-21&#x27;,&#x27;1996-4-21&#x27;,<br>                              &#x27;master&#x27;,10000,null);<br>insert into employees (id, username, gender) values (2, &#x27;zhangshuai&#x27;, &#x27;male&#x27;);<br>insert into employees (id,username,gender) values (2, &#x27;zhangshuai&#x27;, &#x27;male&#x27;),(3, &#x27;zhangshuai&#x27;, &#x27;male&#x27;);<br>#修改<br>#将所有员工的薪资改为5000<br>update employees set salary=5000;<br># 将姓名为&#x27;dashuai&#x27;的员工薪水修改为3000<br>update employees set salary=3000 where username=&#x27;dashuai&#x27;;<br>#删除<br>delete from employees where username=&#x27;dashuai&#x27;;<br>delete from employees;<br></code></pre></td></tr></table></figure>
</li>
<li><p>数据库的备份与导入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">1.#登录mysql进入数据库，source 文件路径<br>2.#cmd, mysql -u root -p dbname&lt;heros.sql<br>##########备份###############<br>#mysqldump -u root -p db_name &gt; honor_of_kings_backup.sql<br></code></pre></td></tr></table></figure>
</li>
<li><p>查询语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select version();<br>#时间和日期相关函数<br>select now();<br>select year(now());<br>select date(now());<br>#和字符串相关的函数<br>select concat (&#x27;_&#x27;,trim(&#x27; ab cd &#x27;),&#x27;_&#x27;);<br>select length(&#x27;ab中国&#x27;);<br>#查询单列<br>select name from heros;<br># 3. 查看多列, 查看所有英雄名字, 最大生命值, 最大法力值, 主要角色定位<br>select name,max_hp,max_mp,role_main from heros;<br>#4. 查看所有列， 查看所有英雄的所有字段 (最好不要在生产环境中使用)<br>select * from heros;<br># 5. 通过where子句过滤记录, (在MySQL中0表示false, 非0表示true)<br>select * from heros where 0;<br>################################# 运算符 ################################<br># 查找name=&#x27;花木兰&#x27;的数据<br>select * from heros where name = &#x27;花木兰&#x27;;<br>select * from heros where name &lt;=&gt; &#x27;花木兰&#x27;;#安全等于<br># 查看所有没有辅助角色定义的英雄名字<br>select name,role_assist from heros where role_assist = null;<br>select name,role_assist from heros where role_assist &lt;&gt;null;<br>select name,role_assist from heros where role_assist  is null;<br># 查看所有有辅助角色定位的英雄名字<br>select name from heros where role_assist is not null;<br>select name from heros where role_assist &lt;&gt; null;<br>## 查看最大生命值在[7350, 8341]范围内的所有英雄, between and<br>select * from heros where max_hp between 7350 and 8341;<br># 查看主要角色定位为战士和坦克的英雄, in<br>select * from heros where role_main in (&#x27;战士&#x27;,&#x27;坦克&#x27;);<br># 查看主要角色定位不为辅助和法师的英雄, not in<br>select name ,role_main from heros where role_main not in(&#x27;辅助&#x27;,&#x27;法师&#x27;);<br># 模糊查询, Like一般是与一些通配符一起使用, 在MySQL中&#x27;_&#x27;表示匹配一个字符, &#x27;%&#x27;表示匹配任意个字符。<br># 在不同的DBMS中, 通配符可能不一样. <br># 查询名字中包含&#x27;太&#x27;的英雄。<br>select name from hreos where name like &#x27;%太%&#x27;;<br># 查询名字中除第一个字符外包含&#x27;太&#x27;字的英雄 <br>select name from heros where name like &#x27;%_太%&#x27;;<br># 查询heros有哪些主要角色定位<br>select role_main from heros;<br>select distinct role_main from heros;<br># 注意事项：<br># 1. 对所有的字段进行去重, 所有字段都相同, 才是相同的记录。<br># 2. disctinct 必须位于所有查询字段的前面<br><br># 在MySQL里面, 我们可以通过 limit 关键字限制数量。不同的DBMS, 限制结果集的关键字可能是不一样的。<br># 查看前三条记录<br>select * from heros limit 3 offset 0;<br>select * from heros limit 3;<br># 查看[6, 10]之间的记录<br>select * from heros limit 5 offset 5;<br># 分页查询, [rows, pageNum] = [8, 3]<br>select * from heros limit 8 offset 16;<br># 根据最大生命值从低到高进行排序<br>select name,hp_max from heros order by hp_max asc;<br># 先根据最大生命值从高到低排序，然后在根据最大法力值从低到高排序。<br>select name,hp_max ,mp_max from heros order by hp_max desc,mp_max asc;<br># 查看最大英雄的最大生命值和最大法力值之和<br>select name,(hp_max + mp_max) as hmp from heros order by hmp desc; <br></code></pre></td></tr></table></figure>
</li>
<li><p>聚合函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># 聚合函数，统计的是列，不是行。(统计行用计算字段)<br># 注意事项：<br>## 1) 聚合函数往往是搭配分组使用的, 如果没有分组，那么统计的就是整张表的数据。<br>## 2) 如果分组了, 那么统计的就是每一组的数据。<br># count()<br>select count(*) from heros; # 69<br>select count(role_assist) from heros; # 不会统计null行<br><br># sum()<br>select sum(hp_max) from heros; # 不会统计null行<br>select sum(name) from heros; <br>select null + 0; # null<br><br># avg()<br>select avg(hp_max) from heros; # 不会统计null行<br>select avg(name) from heros; # <br><br># max()<br>select max(hp_max) from heros; # 不会统计null行<br>select max(name) from heros; <br><br># min()<br>select min(hp_max) from heros; # 不会统计null行<br>select min(name) from heros;<br></code></pre></td></tr></table></figure>
</li>
<li><p>分组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># 分组 group by<br># 注意事项：虽然DBMS实现的时候，往往会对分组进行排序。但是如果没有明确的order by子句<br># 我们就不应该认为结果是有序的。<br><br>select role_main from heros group by role_main;<br># select name, role_main from heros group by role_main;<br>select group_concat(name), role_main from heros group by role_main;<br><br># 1) 搭配聚合函数使用<br>select count(*), role_main from heros group by role_main;<br># 2) 对多字段进行分组<br>select role_main, attack_range from heros group by role_main, attack_range;<br>	<br>select role_main, attack_range from heros group by role_main, attack_range having count(*) &gt; 5;<br><br># where和having都可以过滤, 那它们之间的区别是什么？<br></code></pre></td></tr></table></figure>
</li>
<li><p>约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># 1. 实体完整性 <br># primary key, 独一无二的标识。要求不能为null, 不能重复。一张表最多只有一个主键。<br>create table t_student (<br>	id int primary key,<br>    name varchar(20),<br>    chinese int,<br>    math int,<br>    english int<br>);<br>drop table t_student;<br><br>create table t_student (<br>	id int,<br>    name varchar(20),<br>    chinese int,<br>    math int,<br>    english int,<br>    primary key(id)<br>);<br>show index in t_student;<br># priamry key 可以是多个字段<br>create table xuanke(<br>	sid int,<br>    cid int,<br>    primary key(sid, cid)<br>);<br>show index from xuanke;<br><br># 创建表之后，再指定主键。(不推荐！)<br>drop table xuanke;<br>create table xuanke(<br>	sid int,<br>    cid int<br>);<br>show index from xuanke;<br>alter table xuanke add primary key(sid, cid);<br>show index from xuanke;<br><br>## auto_increment 往往是和 primary key 一起使用。<br>## 1) auto_increment 只能作用于primary key或者是 unique.<br>## 2) auto_increment 只能作用于数值字段。<br>## 3) 一张表只能有一个自增长字段。<br><br>show tables;<br>drop table t_student;<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20),<br>    chinese int,<br>    math int,<br>    english int<br>);<br><br>insert into t_student values (null, &#x27;刘亦菲&#x27;, 100, 100, 100), (null, &#x27;迪丽热巴&#x27;, 80, 80, 80);<br>select * from t_student;<br><br>drop table t_student;<br>create table t_student (<br>	id int unique auto_increment,<br>    name varchar(20),<br>    chinese int unique auto_increment,<br>    math int,<br>    english int<br>);<br><br>#2. 域(field)的完整性<br>#2.1 not null<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int<br>);<br>insert into t_student values (null, null, 100, 100, 100);<br>insert into t_student values (null, &#x27;Thomas_He&#x27;, 100, 100, 100);<br><br>#2.2 unique <br>#注意事项：null可以有多条。<br>create table t_unique(<br>	a int unique<br>);<br>insert into t_unique values (1);<br># insert into t_unique values (1);<br>insert into t_unique values (null);<br>insert into t_unique values (null);<br>select * from t_unique;<br>select count(*) from t_unique;<br><br>#2.3 default 默认值<br>create table t_default(<br>	a int default 100,<br>    b int<br>);<br><br>insert into t_default(a) values(50);<br>insert into t_default(b) values(50);<br>select * from t_default;<br><br>#2.4 check, 自定义约束. MySQL没有实现这个功能，Oracle实现了。<br>create table t_check(<br>	height float(3, 2) check(height between 0.00 and 3.00)<br>);<br>insert into t_check values (1.89);<br>insert into t_check values (3.11);<br>select * from t_check;<br><br># 3. 参照性约束 foreign key(外键)<br>show tables;<br>drop table t_student;<br>drop table xuanke;<br><br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int <br>);<br><br>create table t_class(<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    teacher varchar(20) not null<br>);<br><br>insert into t_class values (null, &#x27;一班&#x27;, &#x27;张三&#x27;),(null, &#x27;二班&#x27;, &#x27;李四&#x27;),(null, &#x27;三班&#x27;, &#x27;王五&#x27;);<br>insert into t_student values (null, &#x27;赵六&#x27;, 100, 100, 100, 100);<br>select * from t_class;<br>select * from t_student;<br><br># 创建外键<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int,<br>    foreign key(cid) references t_class(id)<br>);<br><br>show index in t_student;<br>drop table t_student;<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int,<br>    constraint fk_cid foreign key(cid) references t_class(id)<br>);<br>show index in t_student;<br>drop table t_student;<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int<br>);<br>alter table t_student add constraint fk_cid foreign key(cid) references t_class(id);<br><br># insert into t_student values (null, &#x27;赵六&#x27;, 100, 100, 100, 100);<br>insert into t_student values (null, &#x27;赵六&#x27;, 100, 100, 100, 1);<br>select * from t_student;<br><br>select * from t_class;<br>insert into t_student values (null, &#x27;刘亦菲&#x27;, 100, 100, 100, 1);<br>insert into t_student values (null, &#x27;王语嫣&#x27;, 100, 100, 100, 2);<br>insert into t_student values (null, &#x27;赵灵儿&#x27;, 100, 100, 100, 3);<br><br>## t_students 不能随意的添加和修改。<br># insert into t_student values (null, &#x27;白秀珠&#x27;, 100, 100, 100, 4);<br># update t_student set cid = 4 where name=&#x27;王语嫣&#x27;;<br><br>## t_class 不能随意删除和修改。<br># delete from t_class where id = 1;<br>insert into t_class values (null, &#x27;四班&#x27;, &#x27;Thomas_He&#x27;);<br>delete from t_class where id = 4;<br># update t_class set id=4 where id = 1;<br><br>## 级联删除<br>drop table t_student;<br>drop table t_class;<br>create table t_class(<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    teacher varchar(20) not null<br>);<br>insert into t_class values (null, &#x27;一班&#x27;, &#x27;张三&#x27;),(null, &#x27;二班&#x27;, &#x27;李四&#x27;),(null, &#x27;三班&#x27;, &#x27;王五&#x27;);<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int,<br>    constraint fk_cid foreign key(cid) references t_class(id) on delete cascade<br>);<br>insert into t_student values (null, &#x27;刘亦菲&#x27;, 100, 100, 100, 1);<br>insert into t_student values (null, &#x27;王语嫣&#x27;, 100, 100, 100, 2);<br>insert into t_student values (null, &#x27;赵灵儿&#x27;, 100, 100, 100, 3);<br><br>select * from t_class;<br>select * from t_student;<br><br>delete from t_class where id = 1;<br><br>## 级联置空<br>drop table t_student;<br>drop table t_class;<br>create table t_class(<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    teacher varchar(20) not null<br>);<br>insert into t_class values (null, &#x27;一班&#x27;, &#x27;张三&#x27;),(null, &#x27;二班&#x27;, &#x27;李四&#x27;),(null, &#x27;三班&#x27;, &#x27;王五&#x27;);<br>create table t_student (<br>	id int primary key auto_increment,<br>    name varchar(20) not null,<br>    chinese int,<br>    math int,<br>    english int,<br>    cid int,<br>    constraint fk_cid foreign key(cid) references t_class(id) on delete set null<br>);<br>insert into t_student values (null, &#x27;刘亦菲&#x27;, 100, 100, 100, 1);<br>insert into t_student values (null, &#x27;王语嫣&#x27;, 100, 100, 100, 2);<br>insert into t_student values (null, &#x27;赵灵儿&#x27;, 100, 100, 100, 3);<br><br>select * from t_class;<br>select * from t_student;<br><br>delete from t_class where id = 1;<br># 注意事项: &lt;阿里巴巴开发者手册&gt; 不要在数据库中设置外键，一切的参照完整都应该在业务层中完成。<br># 外键缺点：<br># 1) 影响程序的性能<br># 2）在高并发的场景中容易引起死锁。<br># 3) 当数据量很多的时候，就需要分表。一旦分表，就不能保证参照完整性了。<br><br># 如果参照完整性都在业务中完成，也会导致一些问题。<br># 1) 业务和数据耦合了<br># 2) 增加了业务层的逻辑<br># 3）并不能够从数据库层面保证参照完整性。<br><br># 到底什么时候使用外键<br># 1) 正确性 &gt; 性能<br># 2）并发度不高<br># 3) 数据量不大<br></code></pre></td></tr></table></figure>
</li>
<li><p>子查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># 子查询<br># a. 非关联子查询. 非关联子查询只需要查找一次。<br># b. 关联子查询。<br><br># 查询身高最高的球员有哪些？并且最高身高是多少？ player_id, player_name, height;<br># select player_id, player_name, height from player where height = max(height);<br><br># a. 非关联子查询<br>select player_id, player_name, height from player where height = (select max(height) from player);<br><br># b. 关联子查询<br># 查询每个球队中大于该球队平均身高的球员有哪些？ player_id, team_id, player_name, height;<br>select  player_id, team_id, player_name, height <br>from player AS a<br>where (height &gt; (select avg(height) from player AS b where b.team_id = a.team_id));<br><br># b.1 exists 子查询<br># 如果子查询结果集为空,exist返回false, 否则返回true;<br># 统计出过场的球员有哪些？player_id, player_name, team_id;<br>select player_id, player_name, team_id <br>from player<br>where exists (select * from player_score where player_score.player_id = player.player_id);<br># not exists: 如果子查询结果集为空,exist返回true, 否则返回false;<br># 统计没有出过场的球员有哪些？player_id, player_name, team_id;<br>select player_id, player_name, team_id <br>from player<br>where not exists (select player_id from player_score where player_score.player_id = player.player_id);<br><br># b.2 集合比较子查询<br># IN: 判断是否在集合中<br># 统计出过场的球员有哪些？player_id, player_name, team_id;<br>select player_id, player_name, team_id<br>from player<br>where player_id in (select distinct player_id from player_score);<br><br>select player_id, player_name, team_id<br>from player<br>where player_id in (select player_id from player_score where player_score.player_id = player.player_id);<br><br># 问题：哪一种性能比较好呢？<br>## SELECT * FROM A WHERE EXISTS (SELECT c FROM B WHERE B.c = A.c);<br>## SELECT * FROM A WHERE A.c IN (SELECT c FROM B)<br>## 1) 如果A表的数据比B表大, IN子查询效率比Exists要高。<br>## 2) 如果A表的数据比B表小, Exists子查询比IN子查询效率要高。<br><br># ANY (SOME) 一般和比较操作一起使用，与子查询集合的某个值比较<br># 找出所有比步行者中某一个球员身高要高的球员，并且不是步行者的球员。<br>select player_name, team_id, height from player<br>where height &gt; any(select distinct height from player where team_id = 1002) <br>and team_id != 1002;<br><br>select player_name, team_id, height from player<br>where height &gt; (select min(height) from player where team_id = 1002) <br>and team_id != 1002;<br><br># ALL 一般和比较操作一起使用，与子查询集合的所有值比较<br># 找出所有比步行者中所有球员身高要高的球员，并且不是步行者的球员。<br>select player_name, team_id, height from player<br>where height &gt; all(select distinct height from player where team_id = 1002) <br>and team_id != 1002;<br><br>select player_name, team_id, height from player<br>where height &gt; (select  max(height) from player where team_id = 1002) <br>and team_id != 1002;<br><br># 子查询作为计算字段<br># 查询每个球队的球员数<br>select team_id, team_name, (select count(*) from player where player.team_id = team.team_id) AS team_num from team;     <br><br></code></pre></td></tr></table></figure>
</li>
<li><p>连接查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># Cross Join<br>use nba;<br>select * from player;<br>select count(*) from player; # 37<br>select * from team;<br>select count(*) from team; # 3<br><br>select * from player cross join team; <br>select count(*) from player cross join team; # 111<br><br># 等值连接<br>## 自然连接 natural join<br>SELECT * FROM player NATURAL JOIN team;<br><br>## USING: 指定哪些相同的字段做等值判断。<br>SELECT * FROM player JOIN team USING(team_id);<br><br>## ON: 后面接连接的条件。<br>SELECT * FROM player JOIN team ON player.team_id = team.team_id;<br><br># 非等值连接<br># 我们想查询每个球员的身高级别<br>select * from player;<br>select * from height_grades;<br>select player_name, height, height_level from player join height_grades <br>on height between height_lowest and height_highest;<br><br># 外连接<br>create table t_boys (<br>	id int primary key,<br>    name varchar(20) not null,<br>    gid int<br>);<br>insert into t_boys values (1, &#x27;Albert&#x27;, 1);<br>insert into t_boys values (2, &#x27;Ben&#x27;, 2);<br>insert into t_boys values (3, &#x27;Calvin&#x27;, 100);<br>insert into t_boys values (4, &#x27;David&#x27;, null);<br><br>create table t_girls (<br>	id int primary key,<br>    name varchar(20) not null,<br>    bid int<br>);<br>insert into t_girls values (1, &#x27;Allen&#x27;, 1);<br>insert into t_girls values (2, &#x27;Beyonce&#x27;, 2);<br>insert into t_girls values (3, &#x27;Cindy&#x27;, 100);<br>insert into t_girls values (4, &#x27;Diana&#x27;, null);<br><br>## 左外连接 left [outer] join<br>## 查看所有男生的情况<br>select * from t_boys left join t_girls on t_boys.gid = t_girls.id;<br><br>## 右外连接 right [outer] join<br>## 查看所有女生的情况<br>select * from t_boys right join t_girls on t_girls.bid = t_boys.id;<br><br>## 全外连接 full [outer] join:  MySQL不支持全外连接。<br>## 查看boys and girls 的情况<br>select * from t_boys full join t_girls on t_girls.bid = t_boys.id;<br><br># 5. 自连接<br># 比如我们想要查看比布雷克-格里芬高的球员都有谁？<br>select * from player where player_name = &#x27;布雷克-格里芬&#x27;;<br># 子查询<br>select player_name, height from player <br>where height &gt; (select height from player where player_name = &#x27;布雷克-格里芬&#x27;);<br># 自连接<br>select a.player_name, a.height from player as a join player as b<br>on b.player_name = &#x27;布雷克-格里芬&#x27;<br>where a.height &gt; b.height;<br><br># 推荐使用自连接, DBMS会对自连接进行优化。<br><br># 联合查询<br>## 用左外连接和右外连接实现全外连接。<br>select * from t_boys left join t_girls on t_boys.gid = t_girls.id<br>union<br>select * from t_boys right join t_girls on t_girls.bid = t_boys.id;<br><br>## union all 不会去重。<br>select * from t_boys left join t_girls on t_boys.gid = t_girls.id<br>union all<br>select * from t_boys right join t_girls on t_girls.bid = t_boys.id;<br><br># 不同的DBMS在使用规范上会存在一些差异,并且对SQL标准的支持程度也不一样。<br># a. 不是所有的 DBMS 都支持全外连接。<br># b. Oracle 不能使用 AS 给表起别名。 player p;<br><br># 连接查询需要的注意事项：<br># a. 连接表的数量不能太多。<br># b. 不要忘记连接条件。<br># c. 自连接优于子查询<br></code></pre></td></tr></table></figure>
</li>
<li><p>事务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select @@autocommit; # 默认等于1, <br># autocommit=1, 自动提交事务，会把每一条语句当成一条事务。<br>use nba;<br><br># 显示开启事务方式1, start transaction<br>start transaction;<br>insert into t_boys values (5, &#x27;Thomas_He&#x27;, null);<br>commit;<br><br># autocommit设置成0, 相当于开启了事务。<br><br>set @@autocommit=0;<br>insert into t_boys values (6, &#x27;Thomas_He&#x27;, null);<br>commit;<br><br><br>## rollback<br>start transaction;<br>use nba;<br>insert into t_boys values (7, &#x27;Thomas_He&#x27;, null);<br>rollback;<br>commit;<br><br>## rollback savepoint;<br>start transaction;<br>insert into t_boys values (7, &#x27;Thomas_He&#x27;, null);<br>savepoint sp1;<br>insert into t_boys values (8, &#x27;Thomas_He&#x27;, null);<br>rollback to sp1;<br>commit;<br><br>use nba;<br>show create table t_boys;<br>start transaction;<br>insert into t_boys values (8, &#x27;Thomas_He&#x27;, null);<br>insert into t_boys values (9, null, null);<br>insert into t_boys values (8, &#x27;Thomas_He&#x27;, null);<br>commit;<br><br>## 隔离级别<br>select @@tx_isolation; # 查询的会话的隔离级别。<br>select @@session.tx_isolation; # 查询的会话的隔离级别。<br>select @@global.tx_isolation; # 查询的全局的隔离级别。<br><br>set transaction isolation level read uncommitted; # 设置下一个事务的隔离级别。<br>set session transaction isolation level read uncommitted; # 设置会话的隔离级别。<br>set global transaction isolation level read uncommitted; # 设置全局的隔离级别。<br><br><br>select @@tx_isolation; ## RR<br>select @@global.tx_isolation; ## RR<br># global 隔离级别影响的是以后的会话，当前会话不会影响。<br>set global transaction isolation level repeatable read; <br>select @@tx_isolation; ## RR<br>select @@global.tx_isolation; ## RU<br><br># read uncommitted<br>set session transaction isolation level read uncommitted;<br>select @@tx_isolation;<br><br>use nba;<br>## 脏写(不存在)<br>start transaction;<br>select * from t_boys;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br>## 脏读(存在)<br>start transaction;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br># read committed<br>set session transaction isolation level read committed;<br>select @@tx_isolation;<br><br>## 脏写(不存在)<br>start transaction;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br>## 脏读(不存在)<br>start transaction;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br>## 不可重复读(存在)<br>## 幻读(存在)<br>start transaction;<br>insert into t_boys values (9, &#x27;Thomas_He&#x27;, null);<br>commit;<br><br># repeatable read<br>set session transaction isolation level repeatable read;<br>select @@tx_isolation;<br><br>## 脏写(不存在)<br>start transaction;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br>## 脏读(不存在)<br>start transaction;<br>update t_boys set gid = gid + 100 where id = 1;<br>commit;<br><br>## 不可重复读(不存在)<br>## 幻读<br>start transaction;<br>insert into t_boys values (10, &#x27;Thomas_He&#x27;, null);<br>commit;<br><br># 注意事项：MySQL的RR级别，在一定程度上避免幻读现象。<br><br># serialize <br><br>################################################ 练习 #####################################<br>create database stu_db;<br>use stu_db;<br>create table student(<br>	sid varchar(10),<br>    sname varchar(10),<br>    sage datetime,<br>    sgender varchar(10)<br>);<br>insert into student values(&#x27;01&#x27; , &#x27;赵雷&#x27; , &#x27;1990-01-01&#x27; , &#x27;男&#x27;);<br>insert into student values(&#x27;02&#x27; , &#x27;钱电&#x27; , &#x27;1990-12-21&#x27; , &#x27;男&#x27;);<br>insert into student values(&#x27;03&#x27; , &#x27;孙风&#x27; , &#x27;1990-12-20&#x27; , &#x27;男&#x27;);<br>insert into student values(&#x27;04&#x27; , &#x27;李云&#x27; , &#x27;1990-12-06&#x27; , &#x27;男&#x27;);<br>insert into student values(&#x27;05&#x27; , &#x27;周梅&#x27; , &#x27;1991-12-01&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;06&#x27; , &#x27;吴兰&#x27; , &#x27;1992-01-01&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;07&#x27; , &#x27;郑竹&#x27; , &#x27;1989-01-01&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;09&#x27; , &#x27;张三&#x27; , &#x27;2017-12-20&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;10&#x27; , &#x27;李四&#x27; , &#x27;2017-12-25&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;11&#x27; , &#x27;李四&#x27; , &#x27;2012-06-06&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;12&#x27; , &#x27;赵六&#x27; , &#x27;2013-06-13&#x27; , &#x27;女&#x27;);<br>insert into student values(&#x27;13&#x27; , &#x27;孙七&#x27; , &#x27;2014-06-01&#x27; , &#x27;女&#x27;);<br><br>create table course(<br>	cid varchar(10),<br>    cname varchar(10),<br>    tid varchar(10)<br>);<br>insert into course values(&#x27;01&#x27; , &#x27;语文&#x27; , &#x27;02&#x27;);<br>insert into course values(&#x27;02&#x27; , &#x27;数学&#x27; , &#x27;01&#x27;);<br>insert into course values(&#x27;03&#x27; , &#x27;英语&#x27; , &#x27;03&#x27;);<br><br>create table teacher(<br>	tid varchar(10),<br>    tname varchar(10)<br>);<br>insert into teacher values(&#x27;01&#x27; , &#x27;张三&#x27;);<br>insert into teacher values(&#x27;02&#x27; , &#x27;李四&#x27;);<br>insert into teacher values(&#x27;03&#x27; , &#x27;王五&#x27;);<br><br>create table sc(<br>	sid varchar(10),<br>    cid varchar(10),<br>    score float(5,2)<br>);<br>insert into sc values(&#x27;01&#x27; , &#x27;01&#x27; , 80);<br>insert into sc values(&#x27;01&#x27; , &#x27;02&#x27; , 90);<br>insert into sc values(&#x27;01&#x27; , &#x27;03&#x27; , 99);<br>insert into sc values(&#x27;02&#x27; , &#x27;01&#x27; , 70);<br>insert into sc values(&#x27;02&#x27; , &#x27;02&#x27; , 60);<br>insert into sc values(&#x27;02&#x27; , &#x27;03&#x27; , 80);<br>insert into sc values(&#x27;03&#x27; , &#x27;01&#x27; , 80);<br>insert into sc values(&#x27;03&#x27; , &#x27;02&#x27; , 80);<br>insert into sc values(&#x27;03&#x27; , &#x27;03&#x27; , 80);<br>insert into sc values(&#x27;04&#x27; , &#x27;01&#x27; , 50);<br>insert into sc values(&#x27;04&#x27; , &#x27;02&#x27; , 30);<br>insert into sc values(&#x27;04&#x27; , &#x27;03&#x27; , 20);<br>insert into sc values(&#x27;05&#x27; , &#x27;01&#x27; , 76);<br>insert into sc values(&#x27;05&#x27; , &#x27;02&#x27; , 87);<br>insert into sc values(&#x27;06&#x27; , &#x27;01&#x27; , 31);<br>insert into sc values(&#x27;06&#x27; , &#x27;03&#x27; , 34);<br>insert into sc values(&#x27;07&#x27; , &#x27;02&#x27; , 89);<br>insert into sc values(&#x27;07&#x27; , &#x27;03&#x27; , 98);<br><br>select * from student;<br>select * from course;<br>select * from teacher;<br>select * from sc;<br><br># 查询「李」姓老师的数量<br>select count(*) from teacher where tname like &#x27;李%&#x27;;<br><br># 查询选修「张三」老师课的同学的信息<br># 1. 涉及到哪些表？teacher, course, sc, student<br># 2. 张三老师叫的课程<br>	  select cid, cname, tname<br>      from teacher join course using(tid) where tname=&#x27;张三&#x27;;<br># 3. <br>	select sid from teacher <br>		join course using(tid)<br>		join sc using(cid)<br>		where tname=&#x27;张三&#x27;;<br><br># 4. <br>	select * from student where sid in(<br>		select sid from teacher <br>        join course using(tid)<br>		join sc using(cid)<br>		where tname=&#x27;张三&#x27;<br>    );<br>    <br># 2. 查询 &quot;01&quot; 课程比 &quot;02&quot; 课程成绩高的学生的信息及课程分数 <br># 涉及到哪些表？student, sc<br># 上01课程有哪些学生？(sid, score1)<br>   select sid, score as score1 from sc where cid = &#x27;01&#x27;;    <br># 上02课程有哪些学生？(sid, score2)<br>   select sid, score as score2 from sc where cid = &#x27;02&#x27;;<br># 同时上&#x27;01&#x27;课程和&#x27;02&#x27;课程的同学有哪些？(sid, score1, score2);<br>   select sid, score1, score2 <br>   from (select sid, score as score1 from sc where cid = &#x27;01&#x27;) as t1<br>   join (select sid, score as score2 from sc where cid = &#x27;02&#x27;) as t2<br>   using(sid);<br><br># 关联student<br>   select student.*, score1, score2 from student<br>   join (select sid, score as score1 from sc where cid = &#x27;01&#x27;) as t1 using(sid)<br>   join (select sid, score as score2 from sc where cid = &#x27;02&#x27;) as t2 using(sid)<br>   where score1 &gt; score2;<br>   <br># 3. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩<br>  # 涉及那些表？ student, sc<br>  select sid, sname, avg(score) as avg_score from student join sc using(sid)<br>  group by sid having avg_score &gt;= 60;<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="二、MySQL架构"><a href="#二、MySQL架构" class="headerlink" title="二、MySQL架构"></a>二、MySQL架构</h2><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Ad1AO4Ny-1585737256383)(C:\Users\86133\Desktop\markdown\王道笔记\MySQL\图片1.png)]</p>
<p>MySQL分为server层和储存引擎层。</p>
<p>server层包括连接器，查询缓存，解析器，优化器和执行器涵盖了MySQL大多数核心服务功能。</p>
<p>存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持innoDB，MyISAM，Mermory等多个存储引擎。</p>
<p>Q：修改管理权限以后，可以立即生效吗？ A：不能，下一次生效。</p>
<p>Q：默认连接时长多少？A：28800s,8小时。</p>
<h2 id="三、MySQL是如何工作的？"><a href="#三、MySQL是如何工作的？" class="headerlink" title="三、MySQL是如何工作的？"></a>三、MySQL是如何工作的？</h2><ol>
<li><h6 id="连接器"><a href="#连接器" class="headerlink" title="连接器"></a>连接器</h6><p>当你在客户端输入 mysql –u $user –p $pwd 连接 mysql 的时候，接待你的就是连接器。连接器的作用就是和客户端建立连接、获取权限、维持和管理连接。</p>
</li>
<li><p>查询缓存</p>
<p>建立连接后，就可以执行select语句了。首先MySQL会去查看查询缓存，看下之前是否已经执行过这条查询语句。如果命中缓存，就直接返回。否则就扔给解析器。</p>
</li>
<li><p>解析器</p>
<p>MySQL需要知道你想做什么，因此我们就来到了解析器。解析器会做词法分析和语法分析。词法分析主要是分析每个词的含义，语法分析会判断你写的 SQL 语句是否满足 SQL 语法。</p>
</li>
<li><p>优化器</p>
<p>经过解析器，MySQL就知道你想做什么了。但是在开始执行之前，还需要经过优化器的处理。优化器会优化你的SQL语句。生成最终的执行方案 (execution plan)。然后进入执行器阶段。</p>
</li>
<li><p>执行器</p>
<p>执行器首先会判断你对这张表有没有相应的权限。如果没有，就报错。如果有，就调用相应的存储引擎接口，执行语句。然后将结果集返回给客户端。</p>
</li>
</ol>
<p>Q:为什么不使用查询缓存？</p>
<p>A：一条更新语句就可以清除查询缓存，辛辛苦苦建立起来的缓存容易被擦除掉。MySQL8以后直接取消了这个功能。默认关闭。只在不会更新的表里使用–（不建议使用）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查看mysql支持哪些引擎<br>show engines;<br># 查看默认存储引擎<br>SHOW VARIABLES LIKE ‘%storage_engine%’;<br># 查看某张表的存储引擎<br>SELECT ENGINE FROM information_schema.TABLES<br>WHERE TABLE_SCHEMA=&#x27;$db&#x27;<br>AND TABLE_NAME=&#x27;$table&#x27;;<br></code></pre></td></tr></table></figure>

<h2 id="四、MyISAM"><a href="#四、MyISAM" class="headerlink" title="四、MyISAM"></a>四、MyISAM</h2><ol>
<li>特点：<ul>
<li>查询速度快</li>
<li>支持表锁</li>
<li>支持全文索引</li>
<li>不支持事务</li>
</ul>
</li>
<li>使用MyISAM储存表，会生成三个文件：<ul>
<li>frm   存储表结构，是任何存储引擎都有的。</li>
<li>mvd 存放数据</li>
<li>mvi 存放索引</li>
</ul>
</li>
<li>数据和索引分开存放，这样得索引叫非聚集索引。</li>
</ol>
<h2 id="五、Memory"><a href="#五、Memory" class="headerlink" title="五、Memory"></a>五、Memory</h2><ol>
<li>特点：<ul>
<li>所有数据都存放在内存中，因此数据库重启后会丢失</li>
<li>支持表锁</li>
<li>支持Hash和BTree索引</li>
<li>不支持Blob和Text字段</li>
</ul>
</li>
<li>Memory由于数据都放在内存中，以及支持Hash索引，它的查询速度是最快的。一般使用 Memory 存放临时表。临时表：在单个连接中可见，当连接断开时，临时表也将不复存在。</li>
</ol>
<h2 id="六、innoDB"><a href="#六、innoDB" class="headerlink" title="六、innoDB"></a>六、innoDB</h2><ol>
<li><p>MySQL 5.5 以及以后版本默认的存储引擎。没有特殊应用，Oracle官方推荐使用InnoDB引擎。</p>
</li>
<li><p>特点：</p>
<ul>
<li>支持事务</li>
<li>支持行锁    </li>
<li>支持MVCC</li>
<li>支持崩溃恢复</li>
<li>支持外键一致性约束</li>
</ul>
</li>
<li><p>使用 InnoDB 存储表，会生成两个文件.</p>
<p>.frm # 存储表结构，是任何存储引擎都有的</p>
<p>.ibd # 存放数据和索引</p>
<p>索引和数据存放在一起，这样的索引叫聚集索引。</p>
</li>
</ol>
<h2 id="七、磁盘IO原理"><a href="#七、磁盘IO原理" class="headerlink" title="七、磁盘IO原理"></a>七、磁盘IO原理</h2><blockquote>
<p>磁盘上的数据可以用一个三维地址标识: 柱面号, 盘号, 块号(磁道上的扇区)</p>
<p>读&#x2F;写数据的步骤：</p>
<ol>
<li>移动磁头到指定的柱面号，这个过程被称为定位或查找。</li>
</ol>
<p>​       由于是机械移动, 这部分耗时最高, 最大可达 0.1s.</p>
<ol start="2">
<li><p>根据盘面号确定从哪个磁盘读取数据</p>
</li>
<li><p>盘组开始旋转，将指定的块号移动到读&#x2F;写头下</p>
</li>
</ol>
<p>​       磁盘旋转的速度很快, 一般为7200rpm。旋转一圈大约需要 0.0083s.</p>
<p>​    4. 读写数据</p>
<p>​       数据通过系统总线传送到内存。一般传输一个字节大概需要 0.02us.</p>
<p>​       读写 4KB 大约需要 80us.</p>
<p>磁盘读取数据是以盘块(block)为单位的, 一般为4KB。位于同一盘块的所有数据会被一次性全部读取出来。磁盘IO的代价主要花费在第 1 步。</p>
</blockquote>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-4xEvbCGC-1585737256385)(C:\Users\86133\Desktop\markdown\王道笔记\MySQL\图片2-1585475286999.jpg)]</p>
<p>结论：<em><strong>IO的速度是很慢很慢的，我们应该尽量少地读写磁盘！</strong></em></p>
<h2 id="八、innoDB数据页格式"><a href="#八、innoDB数据页格式" class="headerlink" title="八、innoDB数据页格式"></a>八、innoDB数据页格式</h2><blockquote>
<p>页是 InnoDB 磁盘管理的最小单位。在 InnoDB 存储引擎中, 页默认大小为16KB。</p>
<p>可以通过参数 innodb_page_size 将页的大小设置为 4K、8K 和 16K。</p>
<p>InnoDB 每次至少会将 1 个页的数据从磁盘读取到内存，每次至少也会将 1 个页的数据从内存写到磁盘。</p>
<p>在InnoDB存储引擎中，有很多种页类型。其中最重要的是数据页，也叫 B-tree Node。里面存储了索引和数据的信息。</p>
</blockquote>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ckAzRqlK-1585737256385)(C:\Users\86133\Desktop\markdown\王道笔记\MySQL\图片3-1585475286999.png)]</p>
<blockquote>
<p><strong>File Header</strong></p>
<p>​    主要存储表空间相关信息</p>
<p><strong>Page Header</strong></p>
<p>​    主要存储数据页的元信息</p>
<p><strong>Infimum + Supremum Records</strong></p>
<p>​    每个数据页中有两个虚拟行记录用来限定记录的边界，infimum record 是数据页上最小的记录，supremum record 是数据页上最大的记录。</p>
<p><strong>User Records</strong></p>
<p>​     用户数据，实际存储的行记录。</p>
<p><strong>Free Space</strong></p>
<p>​     空闲空间。</p>
<p><strong>Page Directory</strong></p>
<p>​     页目录，存放了记录的相对位置。</p>
<p><strong>File Trailer</strong></p>
<p>​     位于数据页的最后，用来检测页是否完整地写入磁盘。</p>
</blockquote>
<h2 id="九、索引"><a href="#九、索引" class="headerlink" title="九、索引"></a>九、索引</h2><ol>
<li><p>索引是什么</p>
<p>简单来说，索引的目的就是为了提高数据的查询效率，就像书的目录一样。</p>
<p>一本800页的书，如果想在书中查找某个知识点。在不借助目录的情况下，估计得找好一会儿。同样，对于数据库的表而言，索引就是它的 ”目录”。</p>
<p><strong>索引：</strong>在 MySQL 中也叫做键 (key)，是存储引擎用于快速找到记录的一种数据结构。</p>
</li>
<li><p>哪些数据结构可以作为索引？</p>
<ul>
<li>有序数组 </li>
<li>哈希表 </li>
<li>平衡二叉树</li>
<li>B树</li>
</ul>
</li>
</ol>
<p>​       数据通过系统总线传送到内存。一般传输一个字节大概需要 0.02us.</p>
<blockquote>
<p>​       读写 4KB 大约需要 80us.</p>
<p>磁盘读取数据是以盘块(block)为单位的, 一般为4KB。位于同一盘块的所有数据会被一次性全部读取出来。磁盘IO的代价主要花费在第 1 步。</p>
</blockquote>
<p>[外链图片转存中…(img-4xEvbCGC-1585737256385)]</p>
<p>结论：<em><strong>IO的速度是很慢很慢的，我们应该尽量少地读写磁盘！</strong></em></p>
<h2 id="八、innoDB数据页格式-1"><a href="#八、innoDB数据页格式-1" class="headerlink" title="八、innoDB数据页格式"></a>八、innoDB数据页格式</h2><blockquote>
<p>页是 InnoDB 磁盘管理的最小单位。在 InnoDB 存储引擎中, 页默认大小为16KB。</p>
<p>可以通过参数 innodb_page_size 将页的大小设置为 4K、8K 和 16K。</p>
<p>InnoDB 每次至少会将 1 个页的数据从磁盘读取到内存，每次至少也会将 1 个页的数据从内存写到磁盘。</p>
<p>在InnoDB存储引擎中，有很多种页类型。其中最重要的是数据页，也叫 B-tree Node。里面存储了索引和数据的信息。</p>
</blockquote>
<p>[外链图片转存中…(img-ckAzRqlK-1585737256385)]</p>
<blockquote>
<p><strong>File Header</strong></p>
<p>​    主要存储表空间相关信息</p>
<p><strong>Page Header</strong></p>
<p>​    主要存储数据页的元信息</p>
<p><strong>Infimum + Supremum Records</strong></p>
<p>​    每个数据页中有两个虚拟行记录用来限定记录的边界，infimum record 是数据页上最小的记录，supremum record 是数据页上最大的记录。</p>
<p><strong>User Records</strong></p>
<p>​     用户数据，实际存储的行记录。</p>
<p><strong>Free Space</strong></p>
<p>​     空闲空间。</p>
<p><strong>Page Directory</strong></p>
<p>​     页目录，存放了记录的相对位置。</p>
<p><strong>File Trailer</strong></p>
<p>​     位于数据页的最后，用来检测页是否完整地写入磁盘。</p>
</blockquote>
<h2 id="九、索引-1"><a href="#九、索引-1" class="headerlink" title="九、索引"></a>九、索引</h2><ol>
<li><p>索引是什么</p>
<p>简单来说，索引的目的就是为了提高数据的查询效率，就像书的目录一样。</p>
<p>一本800页的书，如果想在书中查找某个知识点。在不借助目录的情况下，估计得找好一会儿。同样，对于数据库的表而言，索引就是它的 ”目录”。</p>
<p><strong>索引：</strong>在 MySQL 中也叫做键 (key)，是存储引擎用于快速找到记录的一种数据结构。</p>
</li>
<li><p>哪些数据结构可以作为索引？</p>
<ul>
<li>有序数组 </li>
<li>哈希表 </li>
<li>平衡二叉树</li>
<li>B树</li>
<li>B+树</li>
</ul>
</li>
</ol>
<h1 id="未完待续——"><a href="#未完待续——" class="headerlink" title="未完待续——-"></a>未完待续——-</h1>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="print-no-link">#数据库</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>数据库MySQL</div>
      <div>http://example.com/2024/05/27/数据库MySQL入门到入坟/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Anh Tinh</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年5月27日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/05/27/%E6%89%8B%E5%86%99%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8BMyHashMap/" title="MyHashMap">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">MyHashMap</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/27/%E7%B4%AF%E5%8A%A0%E6%A0%91/" title="累加树">
                        <span class="hidden-mobile">累加树</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
